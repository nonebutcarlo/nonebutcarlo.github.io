"use strict";(globalThis["webpackChunkaccount_manager"]=globalThis["webpackChunkaccount_manager"]||[]).push([[7],{8509:(e,t,o)=>{o.d(t,{Z:()=>Q});var i=o(9835),a=o(6970),l=o(1957);const n={class:"text-h6 q-mb-lg"},m={class:"row items-center justify-end"},s=(0,i._)("div",{class:"text-h6"},"Nuovo Tipo",-1);function r(e,t,o,r,d,u){const p=(0,i.up)("q-card-section"),c=(0,i.up)("q-btn"),v=(0,i.up)("q-date"),h=(0,i.up)("q-popup-proxy"),f=(0,i.up)("q-icon"),w=(0,i.up)("q-input"),g=(0,i.up)("q-item-section"),W=(0,i.up)("q-item"),M=(0,i.up)("q-select"),y=(0,i.up)("q-card-actions"),b=(0,i.up)("q-form"),_=(0,i.up)("q-card"),q=(0,i.up)("q-dialog"),D=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(_,{class:"full-width"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i._)("div",n,(0,a.zw)(o.title),1)])),_:1}),(0,i.Wm)(p,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{onSubmit:(0,l.iM)(u.inviaDati,["prevent"]),onReset:u.onReset,ref:"formDati",dense:""},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{outlined:"",class:"q-mb-sm",modelValue:d.movimento.data,"onUpdate:modelValue":t[1]||(t[1]=e=>d.movimento.data=e),required:""},{append:(0,i.w5)((()=>[(0,i.Wm)(f,{name:"event",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{modelValue:d.movimento.data,"onUpdate:modelValue":t[0]||(t[0]=e=>d.movimento.data=e),"today-btn":"",mask:"DD/MM/YYYY"},{default:(0,i.w5)((()=>[(0,i._)("div",m,[(0,i.wy)((0,i.Wm)(c,{label:"Chiudi",color:"primary",flat:""},null,512),[[D]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(M,{class:"col q-mb-sm",outlined:"","use-input":"","input-debounce":"0",modelValue:d.movimento.tipo,"onUpdate:modelValue":t[3]||(t[3]=e=>d.movimento.tipo=e),options:d.tipiOptions,onFilter:u.filterFn,label:"Tipo",rules:[u.myRule],"hide-bottom-space":"",clearable:""},{"no-option":(0,i.w5)((()=>[(0,i.Wm)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{class:"text-grey"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Nessun risultato ")])),_:1})])),_:1})])),append:(0,i.w5)((()=>[(0,i.Wm)(c,{round:"",dense:"",flat:"",icon:"add",onClick:t[2]||(t[2]=(0,l.iM)((e=>d.prompt=!0),["stop"]))})])),_:1},8,["modelValue","options","onFilter","rules"]),(0,i.Wm)(w,{class:"col q-mb-sm",modelValue:d.movimento.descrizione,"onUpdate:modelValue":t[4]||(t[4]=e=>d.movimento.descrizione=e),label:"Descrizione",outlined:"",clearable:""},null,8,["modelValue"]),(0,i.Wm)(w,{class:"col q-mb-sm",modelValue:d.movimento.entrata,"onUpdate:modelValue":t[5]||(t[5]=e=>d.movimento.entrata=e),label:"Entrata",outlined:"",clearable:""},null,8,["modelValue"]),(0,i.Wm)(w,{class:"col q-mb-sm",modelValue:d.movimento.uscita,"onUpdate:modelValue":t[6]||(t[6]=e=>d.movimento.uscita=e),label:"Uscita",outlined:"",clearable:""},null,8,["modelValue"]),(0,i.Wm)(y,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(c,{label:"Annulla",outline:"",color:"primary"},null,512),[[D]]),(0,i.Wm)(c,{type:"submit",unelevated:"",label:"Salva",color:"primary"})])),_:1})])),_:1},8,["onSubmit","onReset"])])),_:1}),(0,i.Wm)(q,{modelValue:d.prompt,"onUpdate:modelValue":t[9]||(t[9]=e=>d.prompt=e),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{style:{"min-width":"350px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[s])),_:1}),(0,i.Wm)(p,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{dense:"",modelValue:d.nuovoTipo,"onUpdate:modelValue":t[7]||(t[7]=e=>d.nuovoTipo=e),autofocus:"",onKeyup:t[8]||(t[8]=(0,l.D2)((e=>(u.addTipo(),d.prompt=!1)),["enter"]))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(y,{align:"right",class:"text-primary"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(c,{flat:"",label:"Annulla"},null,512),[[D]]),(0,i.wy)((0,i.Wm)(c,{flat:"",label:"Aggiungi Tipo",onClick:u.addTipo},null,8,["onClick"]),[[D]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var d=o(4170),u=o(3100);const p={name:"DialogAddEdit",computed:{...(0,u.rn)("tipi",["tipi"]),tipiArray(){return Object.values(this.tipi).map((e=>e.nome)).sort()}},data(){return{oggi:new Date,movimento:this.editMovimento||{tipo:null,descrizione:"",data:d.ZP.formatDate(Date.now(),"DD/MM/YYYY"),entrata:"",uscita:""},prompt:!1,nuovoTipo:"",tipiOptions:[]}},props:{title:{type:String,default:"Missing"},editMovimento:{type:Object,default:null}},methods:{...(0,u.nv)("tipi",["firestoreSaveTipo"]),onReset(){},myRule(e){if(null===e)return"Devi selezionare un elemento"},inviaDati(){this.$refs.formDati.validate().then((e=>{e&&(this.$emit("movimento",this.movimento),this.$emit("close"))}))},filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.tipiOptions=this.tipiArray.filter((e=>e.toLowerCase().indexOf(t)>-1))}:()=>{this.tipiOptions=this.tipiArray})},addTipo(){this.firestoreSaveTipo(this.nuovoTipo).then((()=>{this.movimento.tipo=this.nuovoTipo,this.nuovoTipo="",this.tipiOptions=this.tipiArray}))}}};var c=o(1639),v=o(4458),h=o(3190),f=o(8326),w=o(6611),g=o(2857),W=o(2765),M=o(7088),y=o(4455),b=o(8379),_=o(490),q=o(6749),D=o(1821),Z=o(7743),T=o(2146),V=o(9984),A=o.n(V);const k=(0,c.Z)(p,[["render",r]]),Q=k;A()(p,"components",{QCard:v.Z,QCardSection:h.Z,QForm:f.Z,QInput:w.Z,QIcon:g.Z,QPopupProxy:W.Z,QDate:M.Z,QBtn:y.Z,QSelect:b.Z,QItem:_.Z,QItemSection:q.Z,QCardActions:D.Z,QDialog:Z.Z}),A()(p,"directives",{ClosePopup:T.Z})},6007:(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});var i=o(9835),a=o(6970);const l={class:"row q-ma-lg justify-start"},n=(0,i._)("div",{class:"text-primary text-start text-h5 q-mr-md"},"Saldo",-1),m={class:"q-ma-sm"},s={class:"text-primary"},r={class:"row justify-center"};function d(e,t,o,d,u,p){const c=(0,i.up)("q-space"),v=(0,i.up)("q-btn"),h=(0,i.up)("q-icon"),f=(0,i.up)("q-badge"),w=(0,i.up)("q-item-section"),g=(0,i.up)("q-item-label"),W=(0,i.up)("q-item"),M=(0,i.up)("q-slide-item"),y=(0,i.up)("q-list"),b=(0,i.up)("showAdd-dialog"),_=(0,i.up)("q-dialog"),q=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(q,null,{default:(0,i.w5)((()=>[(0,i._)("div",l,[n,(0,i._)("div",{class:(0,a.C_)(["text-start text-h5",e.saldo>0?"text-positive":"text-negative"])},(0,a.zw)(p.currency(e.saldo)),3),(0,i.Wm)(c),(0,i.Wm)(v,{class:"",icon:"add",rounded:"",color:"primary",onClick:t[0]||(t[0]=e=>u.showAdd=!u.showAdd)})]),(0,i._)("div",m,[(0,i.Wm)(y,{separator:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.movimentiArray,(e=>((0,i.wg)(),(0,i.j4)(M,{onRight:t=>p.slideDelete(t,e),onLeft:t=>p.slideEdit(t,e),"left-color":"orange","right-color":"red",key:e.id,style:{}},{left:(0,i.w5)((()=>[(0,i.Wm)(h,{name:"edit"})])),right:(0,i.w5)((()=>[(0,i.Wm)(h,{name:"delete"})])),default:(0,i.w5)((()=>[(0,i.Wm)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(w,{avatar:""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{color:"primary text-center",innerHTML:p.splitData(e.data)},null,8,["innerHTML"])])),_:2},1024),(0,i.Wm)(w,{class:""},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.tipo),1)])),_:2},1024),(0,i.Wm)(g,{caption:"",lines:"1"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.descrizione),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(w,{class:"",side:""},{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i.Wm)(v,{flat:"",dense:"",size:"sm",round:"",icon:"edit",onClick:t=>p.editMovimento(e)},null,8,["onClick"]),(0,i.Wm)(v,{flat:"",dense:"",size:"sm",round:"",icon:"delete",onClick:t=>p.deleteMovimento(e)},null,8,["onClick"])]),(0,i.Wm)(f,{class:"text-weight-bold",color:e.entrata-e.uscita>0?"positive":"negative"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(p.currency(e.entrata-e.uscita)),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onRight","onLeft"])))),128))])),_:1}),(0,i._)("div",r,[0==e.filtriImpostati?((0,i.wg)(),(0,i.j4)(v,{key:0,class:"q-mt-lg justify-center",flat:"",color:"primary",onClick:t[1]||(t[1]=e=>p.mostraAltri(!1))},{default:(0,i.w5)((()=>[(0,i.Uk)(" Mostra Altri ")])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(v,{class:"q-mt-lg justify-center",flat:"",color:"primary",onClick:t[2]||(t[2]=e=>p.mostraAltri(!0))},{default:(0,i.w5)((()=>[(0,i.Uk)(" Ripristina ")])),_:1})])]),(0,i.Wm)(_,{modelValue:u.showAdd,"onUpdate:modelValue":t[4]||(t[4]=e=>u.showAdd=e),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{title:"Aggiungi Movimento",onMovimento:p.aggiungiMovimento,onClose:t[3]||(t[3]=e=>u.showAdd=!1)},null,8,["onMovimento"])])),_:1},8,["modelValue"]),(0,i.Wm)(_,{modelValue:u.showEdit,"onUpdate:modelValue":t[6]||(t[6]=e=>u.showEdit=e),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{title:"Modifica Movimento",editMovimento:this.movToEdit,onClose:t[5]||(t[5]=e=>u.showEdit=!1),onMovimento:p.aggiornaMovimento},null,8,["editMovimento","onMovimento"])])),_:1},8,["modelValue"])])),_:1})}o(2879);var u=o(3100),p=o(4170),c=(o(4462),o(6283));const v={name:"ListaMovimenti",data(){return{showAdd:!1,showEdit:!1,movToEdit:null,confirm:!1}},mounted(){this.firestoreGetTipi(),this.firestoreGetMovimenti().then((e=>(0,c.hW)(e))).catch((e=>{(0,c.hW)(e,!0),this.$router.push({name:"home"}).catch((()=>{}))}))},unmounted(){this.firestoreStopGettingMovimenti(),this.firestoreStopGettingTipi()},computed:{...(0,u.rn)("movimenti",["movimenti","limite"]),...(0,u.Se)("auth",["saldo"]),...(0,u.Se)("movimenti",["filtriImpostati"]),movimentiArray(){return Object.values(this.movimenti).sort(((e,t)=>e.data===t.data?0:e.data<t.data?1:-1))}},methods:{...(0,u.nv)("movimenti",["firestoreGetMovimenti","firestoreStopGettingMovimenti","firestoreSaveMovimento","firestoreAggiornaMovimento","firestoreDeleteMovimento","incrementLimite"]),...(0,u.nv)("tipi",["firestoreSaveTipo","firestoreGetTipi","firestoreStopGettingTipi"]),currency(e){return new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(e)},splitData(e){return p.ZP.formatDate(e,"DD")+"<br>"+p.ZP.formatDate(e,"MMM")+"<br>"+p.ZP.formatDate(e,"YYYY")},formattaData(e){return p.ZP.formatDate(e,"DD/MM/YYYY")},aggiornaMovimento(e){this.movToEdit=null,this.firestoreAggiornaMovimento(e).then((e=>(0,c.hW)(e))).catch((e=>(0,c.hW)(e,!0)))},aggiungiMovimento(e){this.firestoreSaveMovimento(e).then((e=>(0,c.hW)(e))).catch((e=>(0,c.hW)(e,!0)))},slideEdit({reset:e},t){this.editMovimento(t),e()},editMovimento(e){const t={...e};this.movToEdit=t,this.movToEdit.data=this.formattaData(this.movToEdit.data),this.showEdit=!0},slideDelete({reset:e},t){this.deleteMovimento(t),e()},deleteMovimento(e){this.$q.dialog({persistent:!0,message:"Rimuovo il movimento definitivamente?",ok:{label:"Rimuovi",color:"negative"},cancel:{label:"Annulla"}}).onOk((()=>{this.firestoreDeleteMovimento(e.id).then((e=>(0,c.hW)(e))).catch((e=>(0,c.hW)(e,!0)))}))},mostraAltri(e){this.incrementLimite(e).then((()=>{}))}},components:{"showAdd-dialog":o(8509).Z}};var h=o(1639),f=o(9885),w=o(136),g=o(4455),W=o(3246),M=o(8713),y=o(2857),b=o(490),_=o(6749),q=o(990),D=o(3115),Z=o(7743),T=o(9984),V=o.n(T);const A=(0,h.Z)(v,[["render",d]]),k=A;V()(v,"components",{QPage:f.Z,QSpace:w.Z,QBtn:g.Z,QList:W.Z,QSlideItem:M.Z,QIcon:y.Z,QItem:b.Z,QItemSection:_.Z,QBadge:q.Z,QItemLabel:D.Z,QDialog:Z.Z})}}]);